!function(a){"use strict";a.enplug={debug:!1,classes:{},noop:function(){}}}(window),function(a){"use strict";function b(b,d){function e(b){a.debug&&(arguments[0]=c+arguments[0],console.log.apply(console,arguments))}function f(b){if(b.successCallback&&"function"!=typeof b.successCallback)throw new Error(c+"Success callback must be a function.");if(b.successCallback=b.successCallback||a.noop,b.errorCallback&&"function"!=typeof b.errorCallback)throw new Error(c+"Error callback must be a function.");b.errorCallback=b.errorCallback||a.noop}function g(a){try{var b=JSON.parse(a.data);return b.namespace===d&&"boolean"==typeof b.success?b:!1}catch(c){}return!1}var h="*";this.callId=0,this.pendingCalls={},this.namespace=d,this.send=function(a){if(a.name){a.callId=++this.callId,a.namespace=d,a["transient"]=!!a["transient"],a.persistent=!!a.persistent,f(a),e("Calling method:",a),a["transient"]||(this.pendingCalls[a.callId]=a);try{var g=JSON.stringify(a);b.parent.postMessage(g,h)}catch(i){console.error(c+"Error:",i)}return a.callId}throw new Error(c+"All transport method calls must have a name.")},this.handleEvent=function(a){if("message"===a.type){var b=g(a);if(b){var c=this.pendingCalls[b.callId];if(c){c.persistent||delete this.pendingCalls[b.callId],e("Calling method "+(b.success?"success":"error")+" callback:",{call:c,response:b});var d=b.success?c.successCallback:c.errorCallback;return d(b.data),!0}}}return!1},this.cleanup=function(){b.removeEventListener("message",this,!1)},b.addEventListener("message",this,!1)}var c="[Enplug SDK] ";b.prototype.TAG=c,a.classes.Transport=b}(window.enplug),function(a,b){"use strict";function c(c){if(!c)throw new Error(b.classes.Transport.prototype.TAG+"Senders must specify a method prefix.");this.prefix=c,this.novalidate=!1,this.transport=new b.classes.Transport(a,c)}c.prototype={validate:function(a,b,c){if(!this.novalidate&&(null===a||typeof a!==b||"array"===b&&!Array.isArray(a)))throw new Error(this.transport.TAG+c)},method:function(a){if("object"==typeof a)return a.name=this.prefix+"."+a.name,this.transport.send(a);throw new Error("Transport options must be an object.")},cleanup:function(){this.transport.cleanup()}},b.classes.Sender=c}(window,window.enplug),function(a){"use strict";function b(){a.classes.Sender.call(this,"app"),this.getAccount=function(a,b){return this.method({name:"getAccount",successCallback:a,errorCallback:b})},this.getDisplayGroup=function(a,b){return this.method({name:"getDisplay",successCallback:a,errorCallback:b})},this.getInstances=function(a,b,c){return this.validate(a,"string","Missing account ID (string)."),this.method({name:"getInstances",params:a,successCallback:b,errorCallback:c})},this.getAssets=function(a,b){return this.method({name:"getAssets",successCallback:a,errorCallback:b})},this.getDefaultAssets=function(a,b){return this.method({name:"getDefaultAssets",successCallback:a,errorCallback:b})},this.createAsset=function(a,b,c,d){return this.validate(a,"string","You must provide a name (string) when creating an asset."),this.validate(b,"object","You must provide a value (object) when creating an asset."),this.method({name:"createAsset",params:[a,b],successCallback:c,errorCallback:d})},this.createAssetFromDefault=function(a,b,c){return this.validate(a,"string","Missing default asset ID (string)."),this.method({name:"createAssetFromDefault",params:a,successCallback:b,errorCallback:c})},this.updateAsset=function(a,b,c,d){return this.validate(a,"string","You must provide the ID (string) of an asset to update."),this.validate(b,"object","You must provide the new value (object) of an asset to update."),this.method({name:"updateAsset",params:[a,b],successCallback:c,errorCallback:d})},this.bulkCreateAssets=function(a,b,c){return this.validate(a,"object","You must provide an array of assets to bulk create."),this.method({name:"bulkCreateAssets",params:a,successCallback:b,errorCallback:c})},this.bulkUpdateAssets=function(a,b,c){return this.validate(a,"object","You must provide an array of assets to bulk update."),this.method({name:"bulkUpdateAssets",params:a,successCallback:b,errorCallback:c})},this.bulkRemoveAssets=function(a,b,c){return this.validate(a,"object","You must provide an array of asset IDs to bulk remove."),this.method({name:"bulkRemoveAssets",params:a,successCallback:b,errorCallback:c})},this.removeAsset=function(a,b,c){return this.validate(a,"string","You must provide the ID (string) of the asset to remove."),this.method({name:"removeAsset",params:[a],successCallback:b,errorCallback:c})},this.getThemes=function(a,b){return this.method({name:"getThemes",successCallback:a,errorCallback:b})},this.createTheme=function(a,b,c){return this.validate(a,"object","You must provide the new theme (object) to create."),this.method({name:"createTheme",params:a,successCallback:b,errorCallback:c})},this.removeTheme=function(a,b,c){return this.validate(a,"string","You must provide the ID (string) of the theme to remove."),this.method({name:"removeTheme",params:a,successCallback:b,errorCallback:c})},this.activateTheme=function(a,b,c){return this.validate(a,"string","You must provide the ID (string) of the theme to activate."),this.method({name:"activateTheme",params:a,successCallback:b,errorCallback:c})},this.getDisplay=this.getDisplayGroup}b.prototype=Object.create(a.classes.Sender.prototype),a.classes.AccountSender=b,a.account=new b}(window.enplug),function(a,b){"use strict";function c(){function c(){return g.click(),!0}a.classes.Sender.call(this,"dashboard");var d=[],e=function(){},f=!0;this.setHeaderTitle=function(a,b,c){return this.validate(a,"string","Header title must be a string."),this.method({name:"set.title",params:a,successCallback:b,errorCallback:c})},this.setDisplaySelectorCallback=function(a,b){return this.validate(a,"function","To enable the display selector in the page title you must supply a callback function."),e=a,this.method({name:"set.selector",params:a,persistent:!0,successCallback:function(a){return console.log("setDisplaySelectorCallback successCB fired: %o",arguments),a&&e(a),a},errorCallback:b})},this.disableDisplaySelector=function(a,b){return this.method({name:"set.selector",params:!1,persistent:!0,successCallback:a,errorCallback:b})},this.setHeaderButtons=function(a,b,c){this.validate(a,"object","Header buttons must be an object (single) or array (multiple)."),d=[],a=Array.isArray(a)?a:[a];for(var e=0;e<a.length;e++){var f=a[e];this.validate(f,"object","Header buttons must be objects."),f&&(this.validate(f.action,"function","Header buttons must have an action (function)."),f.id="button-"+Math.round(9999*Math.random()+1),d[f.id]=f)}return this.method({name:"set.buttons",params:a,persistent:!0,successCallback:function(a){if(a){var c=d[a.id];c?c.action():console.warn("Unrecognized button click:",a)}"function"==typeof b&&b(a)},errorCallback:c})},this.pageLoading=function(a,b,c){return this.validate(a,"boolean","Page loading status must be a boolean."),this.method({name:"page.loading",params:a,successCallback:function(){f=a,"function"==typeof b&&b(f)},errorCallback:c})},this.isLoading=function(){return f},this.pageError=function(a,b){return this.method({name:"page.error",successCallback:a,errorCallback:b})},this.pageNotFound=function(a,b){return this.method({name:"page.notFound",successCallback:a,errorCallback:b})},this.loadingIndicator=function(a,b,c){return this.validate(a,"string","Loading indicator requires a loading message (string)"),this.method({name:"indicator.loading",params:a,successCallback:b,errorCallback:c})},this.successIndicator=function(a,b,c){return this.validate(a,"string","Success indicator requires a success message (string)"),this.method({name:"indicator.success",params:a,successCallback:b,errorCallback:c})},this.errorIndicator=function(a,b,c){return this.validate(a,"string","Error indicator requires an error message (string)"),this.method({name:"indicator.error",params:a,successCallback:b,errorCallback:c})},this.openConfirm=function(a,b,c){return this.validate(a,"object","Confirm box requires options to be set (object)."),a&&(this.validate(a.title,"string","Confirm box requires options.title to be set (string)."),this.validate(a.text,"string","Confirm box requires options.text to be set (string).")),this.method({name:"confirm",params:a,successCallback:b,errorCallback:c})},this.confirmUnsavedChanges=function(a,b){return this.method({name:"unsavedChanges",successCallback:a,errorCallback:b})},this.upload=function(a,b,c){return this.method({name:"upload",params:a,successCallback:b,errorCallback:c})},this.cleanup=function(){b.removeEventListener("click",c,!1),a.classes.Sender.prototype.cleanup.call(this)},this.click=function(){return this.method({name:"click","transient":!0})};var g=this;b.addEventListener("click",c,!1)}c.prototype=Object.create(a.classes.Sender.prototype),a.classes.DashboardSender=c,a.dashboard=new c}(window.enplug,document),function(a,b){"use strict";function c(b,c,d){var e=d.send;d.send=function(f){var g=b.defer(),h=f.successCallback||a.noop,i=f.errorCallback||a.noop;return f.successCallback=function(a){c.$apply(function(){g.resolve(a),h(a)})},f.errorCallback=function(a){c.$apply(function(){g.reject(a),i(a)})},e.call(d,f),g.promise}}function d(a){return function(a){return function(d,e){var f=a.charAt(0).toUpperCase()+a.slice(1)+"Sender",g=new b.classes[f];return b[a].cleanup(),b[a]=g,c(d,e,g.transport),g}}(a)}if(a){var e=a.module("enplug.sdk",[]);e.factory("$enplugDashboard",["$q","$rootScope",d("dashboard")]),e.factory("$enplugAccount",["$q","$rootScope",d("account")])}}(window.angular,window.enplug);